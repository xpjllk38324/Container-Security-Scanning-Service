digraph VulnerabilityManagement_Aggregate {
  node [shape=plaintext];

  VulnerabilityEntryManager [label=<
    <table border="0" cellborder="1" cellspacing="0">
      <tr><td><b>«root» VulnerabilityEntryManager</b></td></tr>
      <tr><td align="left">+ addEntry(record: VulnerabilityRecord)<br 
align="left"/>+ deleteEntry(id: UUID)<br align="left"/>+ 
updateEntry(record: VulnerabilityRecord)<br align="left"/>+ 
findEntryById(id: UUID): VulnerabilityRecord<br align="left"/>+ 
listAllEntries(): List&lt;VulnerabilityRecord&gt;<br align="left"/>+ 
getEntriesBySeverity(severity: Severity): 
List&lt;VulnerabilityRecord&gt;</td></tr>
    </table>>];

  VulnerabilityDatabase [label=<
    <table border="0" cellborder="1" cellspacing="0">
      <tr><td><b>«entity» VulnerabilityDatabase</b></td></tr>
      <tr><td align="left">- id: UUID<br align="left"/>- name: String<br 
align="left"/>- dateUpdated: Date</td></tr>
      <tr><td border="1" align="left">+ getVulnerabilityRecords(): 
List&lt;VulnerabilityRecord&gt;<br align="left"/>+ updateDatabase(records: 
List&lt;VulnerabilityRecord&gt;)</td></tr>
    </table>>];

  VulnerabilityRecord [label=<
    <table border="0" cellborder="1" cellspacing="0">
      <tr><td><b>«value object» VulnerabilityRecord</b></td></tr>
      <tr><td align="left">- id: UUID<br align="left"/>- severity: 
Severity<br align="left"/>- description: String<br align="left"/>- 
fixAvailable: Boolean</td></tr>
      <tr><td border="1" align="left">+ isCritical(): Boolean<br 
align="left"/>+ getSeverity(): Severity<br align="left"/>+ 
getDescription(): String<br align="left"/>+ isFixAvailable(): 
Boolean</td></tr>
    </table>>];

  Severity [label=<
    <table border="0" cellborder="1" cellspacing="0">
      <tr><td><b>«enum» Severity</b></td></tr>
      <tr><td align="left">+ LOW: Severity<br align="left"/>+ MEDIUM: 
Severity<br align="left"/>+ HIGH: Severity<br align="left"/>+ CRITICAL: 
Severity</td></tr>
    </table>>];

  // Relationships within the VulnerabilityManagement Aggregate
  VulnerabilityEntryManager -> VulnerabilityRecord [label="1..* manages" 
arrowtail=odiamond dir=back];
  VulnerabilityDatabase -> VulnerabilityRecord [label="1..* contains" 
arrowtail=odiamond dir=back];
  VulnerabilityEntryManager -> VulnerabilityDatabase [label="1 manages"];
  VulnerabilityRecord -> Severity [label="uses"];
}

